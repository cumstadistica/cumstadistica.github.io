{{- /* Initialize empty slices for the lists */ -}}
{{- $categoriesList := slice -}}
{{- $tagsList := slice -}}
{{- $authorList := slice -}}
{{- $langList := slice -}}

{{- /* 1. Process Categories */ -}}
{{- if .Site.Taxonomies.categories -}}
  {{- range $name, $taxonomy := $.Site.Taxonomies.categories -}}
    {{- $catPage := site.GetPage (printf "%s/categories/%s" $.Site.Language.Lang $name) -}}
    {{- if not $catPage -}}
      {{- $catPage = site.GetPage (printf "categories/%s" $name) -}}
    {{- end -}}
    {{- $details := dict 
        "name" ($catPage.Title | default ($name | humanize | title)) 
        "description" ($catPage.Params.description)
        "slug" ($name | urlize)
        "count" (len $taxonomy) 
        "url" (printf "/categories/%s/" ($name | urlize) | absURL)
    -}}
    {{- $categoriesList = $categoriesList | append $details -}}
  {{- end -}}
{{- end -}}
{{- if .Site.Taxonomies.tags -}}
  {{- range $name, $taxonomy := .Site.Taxonomies.tags -}}
    {{- $details := dict 
        "name" ($name | humanize | title) 
        "slug" ($name | urlize)
        "count" (len $taxonomy) 
        "url" (printf "/tags/%s/" ($name | urlize) | absURL)
    -}}
    {{- $tagsList = $tagsList | append $details -}}
  {{- end -}}
{{- end -}}

{{- /* 2. Process Authors */ -}}
{{- if .Site.Taxonomies.author -}}
  {{- range $name, $taxonomy := .Site.Taxonomies.author -}}
    {{- $authorPage := site.GetPage (printf "author/%s" $name) -}}
    {{- $details := dict 
        "name" ($name | humanize | title)
        "code" $name 
        "count" (len $taxonomy) 
        "url" (printf "/author/%s/" ($name | urlize) | absURL)
    -}}
    {{- if $authorPage -}}
      {{- $details = merge $details (dict 
          "name" $authorPage.Title
          "slogan" $authorPage.Params.slogan
          "image" $authorPage.Params.image
          "telegram" $authorPage.Params.telegram
      ) -}}
    {{- end -}}
    {{- $authorList = $authorList | append $details -}}
  {{- end -}}
{{- end -}}


{{ range .Site.Languages }}
    {{- $details := dict 
        "code" $.Lang
    -}}
{{- $langList = $langList | append $details -}}
{{ end }}


{{- dict "category" $categoriesList "tag" $tagsList "author" $authorList "lang" $langList | jsonify -}}