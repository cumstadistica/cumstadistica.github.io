{{/* Quote shortcode - displays a blockquote with optional attribution */}}
{{ $text := .Get "text" | default (.Get 0) }}
{{ $authorCode := .Get "author" | default "" }}

<div class="flex mv3">
    {{ if $authorCode }}
        {{ $authorPage := site.GetPage (printf "/author/%s" $authorCode) }}
        {{ if $authorPage }}
            {{ with $authorPage.Params.image }}
                <div class="flex-shrink-0 mr3 mt4 ml4">
                    <a href="{{ $authorPage.RelPermalink }}">
                        <img src="{{ . }}" alt="{{ $authorPage.Title }}" class="br3 object-cover" style="width: 80px; height: 80px;">
                    </a>
                </div>
            {{ end }}
        {{ end }}
    {{ end }}
    
    <blockquote class="bl bw3 b--light-blue pl3 pv2 i flex-auto">
        <div class="lh-copy">{{ $text | markdownify }}</div>
        {{ if $authorCode }}
            {{ $authorPage := site.GetPage (printf "/author/%s" $authorCode) }}
            {{ if $authorPage }}
                <footer class="mt2 i i-reset f6 silver">
                    <a href="{{ $authorPage.RelPermalink }}" class="link light-blue">{{ $authorPage.Title }}</a>
                </footer>
            {{ else if strings.Contains $authorCode "://" }}
                <footer class="mt2 i i-reset f6 silver">
                    <a href="{{ $authorCode }}" class="link light-blue" target="_blank">{{ $authorCode }}</a>
                </footer>
            {{ else }}
                <footer class="mt2 i i-reset f6 silver">â€” {{ $authorCode }}</footer>
            {{ end }}
        {{ end }}
    </blockquote>
</div>
